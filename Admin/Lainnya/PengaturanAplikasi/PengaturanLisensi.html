<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengaturan Lisensi Aplikasi :: Akeno PPDB System</title>

    <!-- Bootstrap 4 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-light">

    <!-- NAVBAR -->
    <div id="navbar"></div>

    <!-- BREADCRUMB -->
    <div class="container-fluid mt-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb bg-white rounded shadow-sm">
                <li class="breadcrumb-item"><a href="#" class="text-decoration-none">Lainnya</a></li>
                <li class="breadcrumb-item"><a href="#" class="text-decoration-none">Pengaturan Aplikasi</a></li>
                <li class="breadcrumb-item active">Pengaturan Lisensi</li>
            </ol>
        </nav>
    </div>

    <!-- PAGE HEADER -->
    <div class="container-fluid">
        <div class="row mb-4 ml-2">
            <div class="col">
                <h2 class="font-weight-bold mb-1">
                    <i class="fas fa-certificate text-warning mr-2"></i>Pengaturan Lisensi
                </h2>
                <p class="text-muted mb-0">Informasi lisensi aplikasi yang terpasang</p>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="container-fluid mb-5">
        <div class="row">
            <div class="col-12">

                <!-- Alert Section -->
                <div id="alert-box" class="alert alert-dismissible fade" role="alert" style="display: none;">
                    <div class="d-flex align-items-center">
                        <i id="alert-icon" class="fas fa-info-circle fa-2x mr-3"></i>
                        <div class="flex-grow-1">
                            <h6 id="alert-title" class="font-weight-bold mb-1"></h6>
                            <div id="alert-content"></div>
                        </div>
                    </div>
                    <button type="button" class="close" onclick="hideAlert()">
                        <span>&times;</span>
                    </button>
                </div>

                <!-- Settings Card -->
                <div class="card border-0 rounded">
                    <div class="row no-gutters">

                        <!-- Sidebar Menu -->
                        <div class="col-3 d-none d-md-block bg-light border-right">
                            <div class="p-4 shadow">
                                <h6 class="font-weight-bold text-muted mb-3 text-uppercase small">Menu Pengaturan</h6>
                                <div class="list-group list-group-flush">
                                    <a href="PengaturanUmumLainnya.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-cog text-primary mr-2"></i>Pengaturan Umum
                                    </a>

                                    <a href="PengaturanTampilan.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-palette text-success mr-2"></i>Pengaturan Tampilan
                                    </a>

                                    <a href="PengaturanSistem.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-server text-secondary mr-2"></i>Pengaturan Sistem
                                    </a>

                                    <a href="PengaturanFitur.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-box text-warning mr-2"></i>Pengaturan Fitur
                                    </a>

                                    <a href="PengaturanPembayaran.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-shield-alt text-success mr-2"></i>Pengaturan Pembayaran
                                    </a>

                                    <a href="PengaturanServerAPI.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-plug text-info mr-2"></i>Pengaturan Server API
                                    </a>

                                    <a href="PengaturanNotifikasi.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-bell text-primary mr-2"></i>Pengaturan Notifikasi
                                    </a>

                                    <a href="PengaturanLisensi.html"
                                        class="list-group-item list-group-item-action border-top-0 border-left-0 border-right-0 rounded mb-2 shadow-sm border-bottom border-primary">
                                        <i class="fas fa-certificate text-warning mr-2"></i>Pengaturan Lisensi
                                    </a>

                                    <a href="PencadanganData.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-database text-danger mr-2"></i>Pencadangan Data
                                    </a>

                                    <a href="ModePemeliharaan.html"
                                        class="list-group-item list-group-item-action border-0 rounded mb-2 shadow-sm">
                                        <i class="fas fa-wrench text-secondary mr-2"></i>Mode Pemeliharaan
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="col-12 col-md-9 shadow">
                            <div class="p-4 bg-white border rounded">

                                <!-- Mobile Menu Dropdown (Only visible on mobile) -->
                                <div class="d-md-none mb-4">
                                    <div class="dropdown">
                                        <button class="btn btn-primary btn-block shadow-sm dropdown-toggle"
                                            type="button" id="mobileMenuDropdown" data-toggle="dropdown"
                                            aria-haspopup="true" aria-expanded="false">
                                            <i class="fas fa-bars mr-2"></i>Menu Pengaturan
                                        </button>
                                        <div class="dropdown-menu w-100 shadow" aria-labelledby="mobileMenuDropdown">
                                            <a class="dropdown-item" href="PengaturanUmumLainnya.html">
                                                <i class="fas fa-cog text-primary mr-2"></i>Pengaturan Umum
                                            </a>
                                            <a class="dropdown-item" href="PengaturanTampilan.html">
                                                <i class="fas fa-palette text-success mr-2"></i>Pengaturan Tampilan
                                            </a>
                                            <a class="dropdown-item" href="PengaturanSistem.html">
                                                <i class="fas fa-server text-secondary mr-2"></i>Pengaturan Sistem
                                            </a>
                                            <a class="dropdown-item" href="PengaturanFitur.html">
                                                <i class="fas fa-box text-warning mr-2"></i>Pengaturan Fitur
                                            </a>
                                            <a class="dropdown-item" href="PengaturanPembayaran.html">
                                                <i class="fas fa-shield-alt text-success mr-2"></i>Pengaturan Pembayaran
                                            </a>
                                            <a class="dropdown-item" href="PengaturanServerAPI.html">
                                                <i class="fas fa-plug text-info mr-2"></i>Pengaturan Server API
                                            </a>
                                            <a class="dropdown-item" href="PengaturanNotifikasi.html">
                                                <i class="fas fa-bell text-primary mr-2"></i>Pengaturan Notifikasi
                                            </a>
                                            <a class="dropdown-item active font-weight-bold"
                                                href="PengaturanLisensi.html">
                                                <i class="fas fa-certificate text-warning mr-2"></i>Pengaturan Lisensi
                                            </a>
                                            <a class="dropdown-item" href="PencadanganData.html">
                                                <i class="fas fa-database text-danger mr-2"></i>Pencadangan Data
                                            </a>
                                            <a class="dropdown-item" href="ModePemeliharaan.html">
                                                <i class="fas fa-wrench text-secondary mr-2"></i>Mode Pemeliharaan
                                            </a>
                                        </div>
                                    </div>
                                </div>

                                <!-- License Information Header -->
                                <div class="border-bottom pb-3 mb-4">
                                    <h4 class="font-weight-bold mb-1">
                                        <i class="fas fa-award text-warning mr-2"></i>Informasi Lisensi Aplikasi
                                    </h4>
                                    <p class="text-muted mb-0 small">
                                        Detail lisensi yang terpasang pada sistem
                                    </p>
                                </div>

                                <!-- License Information Table -->
                                <div class="table-responsive mb-4">
                                    <table class="table table-bordered">
                                        <tbody>
                                            <tr>
                                                <td class="font-weight-bold" style="width: 40%;">
                                                    <i class="fas fa-tag text-primary mr-2"></i>Nama Aplikasi
                                                </td>
                                                <td>Solusi Sistem Keuangan Sekolah</td>
                                            </tr>
                                            <tr>
                                                <td class="font-weight-bold">
                                                    <i class="fas fa-code-branch text-info mr-2"></i>Versi Aplikasi
                                                </td>
                                                <td>1.8.0</td>
                                            </tr>
                                            <tr>
                                                <td class="font-weight-bold">
                                                    <i class="fas fa-user text-success mr-2"></i>Nama Terdaftar
                                                </td>
                                                <td>Akeno PPDB System</td>
                                            </tr>
                                            <tr>
                                                <td class="font-weight-bold">
                                                    <i class="fas fa-envelope text-warning mr-2"></i>Email Terdaftar
                                                </td>
                                                <td>info@aplikasi-spa.com</td>
                                            </tr>
                                            <tr>
                                                <td class="font-weight-bold">
                                                    <i class="fas fa-check-circle text-success mr-2"></i>Status Lisensi
                                                </td>
                                                <td>
                                                    <span class="badge badge-success">
                                                        <i class="fas fa-check mr-1"></i>Aktif
                                                    </span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- License Information Card -->
                                <div class="card bg-light border-0 mb-4">
                                    <div class="card-body">
                                        <div class="d-flex align-items-start">
                                            <i class="fas fa-info-circle text-info fa-2x mr-3 mt-1"></i>
                                            <div>
                                                <h6 class="font-weight-bold mb-2">Informasi Penting</h6>
                                                <p class="text-muted mb-0 small">
                                                    Lisensi aplikasi diperlukan untuk menggunakan seluruh fitur sistem.
                                                    Pastikan lisensi Anda tetap aktif untuk penggunaan yang optimal.
                                                    Jika Anda menghapus lisensi, aplikasi tidak dapat digunakan dan
                                                    perlu aktivasi ulang.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Action Button -->
                                <div class="mt-4">
                                    <button type="button" id="btn-remove-license" class="btn btn-secondary shadow-sm">
                                        <i class="fas fa-trash-alt mr-2"></i>
                                        Hapus Lisensi Terpasang
                                    </button>
                                    <small class="form-text text-secondary mt-2">
                                        <i class="fas fa-exclamation-triangle mr-1 text-danger"></i>
                                        <strong>Peringatan:</strong> Tindakan ini akan menonaktifkan aplikasi
                                    </small>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi Hapus Lisensi -->
    <div class="modal fade" id="modal-remove-license" data-backdrop="static" data-keyboard="false" tabindex="-1"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center pt-4 pb-2">
                    <i class="fas fa-exclamation-triangle text-danger" style="font-size: 3.5rem;"></i>
                    <h5 class="mt-3 font-weight-bold">Hapus Lisensi Aplikasi</h5>
                    <p class="text-muted mt-3 mb-4">
                        Apakah anda yakin akan menghapus lisensi aplikasi yang terpasang pada perangkat?
                        Setelah lisensi terhapus maka aplikasi menjadi tidak dapat digunakan.
                    </p>
                </div>
                <div class="modal-footer">
                    <div class="row w-100">
                        <div class="col-6">
                            <button type="button" id="btn-remove-abort" class="btn btn-secondary btn-block">
                                <i class="fas fa-times mr-1"></i>Batalkan
                            </button>
                        </div>
                        <div class="col-6">
                            <button type="button" id="btn-remove-submit" class="btn btn-danger btn-block">
                                <span id="btn-remove-icon" class="spinner-border spinner-border-sm mr-2"
                                    style="display: none;"></span>
                                <i id="btn-remove-svg" class="fas fa-check-circle mr-1"></i>
                                Konfirmasi
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white py-3 mt-5">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0 text-muted">Powered By Akeno PPDB System &copy; 2022-2025</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>

    <script>
        fetch("../../../Navbar/navbar.html")
            .then(res => res.text())
            .then(html => {
                const navbar = document.getElementById("navbar");
                navbar.innerHTML = html;

                // Menjalankan ulang semua script yang ada di navbar.html
                navbar.querySelectorAll("script").forEach(oldScript => {
                    const newScript = document.createElement("script");
                    if (oldScript.src) {
                        newScript.src = oldScript.src;
                    } else {
                        newScript.innerHTML = oldScript.innerHTML;
                    }
                    document.body.appendChild(newScript);
                });

                // PANGGIL FUNGSI ACTIVE STATE SETELAH NAVBAR LOADED
                // Tunggu 200ms untuk memastikan semua script navbar selesai
                setTimeout(function () {
                    setActiveNavbar();
                }, 200);
            });

        // ===============================
        //  GLOBAL ALERT HANDLER
        // ===============================
        function showAlert(type, title, message) {
            const alertBox = $("#alert-box");
            const icon = $("#alert-icon");

            const types = {
                success: { icon: "fa-check-circle", class: "alert-success" },
                error: { icon: "fa-times-circle", class: "alert-danger" },
                info: { icon: "fa-info-circle", class: "alert-info" },
                warning: { icon: "fa-exclamation-triangle", class: "alert-warning" }
            };

            // reset class
            alertBox.removeClass("alert-success alert-danger alert-info alert-warning");

            // apply class
            alertBox.addClass(types[type].class);

            // icon
            icon.attr("class", `fas ${types[type].icon} fa-2x mr-3`);

            $("#alert-title").text(title);
            $("#alert-content").html(message);

            alertBox.show().addClass("show");
        }

        function hideAlert() {
            $("#alert-box").removeClass("show").fadeOut(150);
        }



        // ===============================
        //  EVENT TOMBOL HAPUS LISENSI
        // ===============================
        $("#btn-remove-license").on("click", function () {
            $("#modal-remove-license").modal("show");
        });


        // ===============================
        //  TOMBOL BATAL DI MODAL
        // ===============================
        $("#btn-remove-abort").on("click", function () {
            $("#modal-remove-license").modal("hide");
        });



        // ===============================
        //  KONFIRMASI HAPUS LISENSI
        // ===============================
        $("#btn-remove-submit").on("click", function () {

            // tombol loading
            $("#btn-remove-svg").hide();
            $("#btn-remove-icon").show();
            $("#btn-remove-submit").prop("disabled", true);

            // Simulasi request API
            setTimeout(() => {

                const success = true; // ubah ke false untuk test error

                if (success) {
                    $("#modal-remove-license").modal("hide");

                    showAlert(
                        "success",
                        "Lisensi Berhasil Dihapus",
                        "Aplikasi akan dinonaktifkan. Silakan melakukan aktivasi ulang jika ingin menggunakan kembali."
                    );

                    // reload otomatis
                    setTimeout(() => location.reload(), 2000);

                } else {
                    showAlert(
                        "error",
                        "Gagal Menghapus Lisensi",
                        "Terjadi kesalahan saat menghapus lisensi. Silakan coba kembali."
                    );
                }

                $("#btn-remove-svg").show();
                $("#btn-remove-icon").hide();
                $("#btn-remove-submit").prop("disabled", false);

            }, 1300);

        });
    </script>

</body>

</html>