<!doctype html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Tambah Data Pendaftar :: PPDB</title>

    <!-- Bootstrap 4 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="bg-light">

    <!-- NAVBAR -->
    <div id="navbar"></div>

    <!-- MAIN CONTENT -->
    <div class="container-fluid py-4">

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-3">
            <ol class="breadcrumb bg-white shadow-sm rounded">
                <li class="breadcrumb-item"><a href="#"
                        class="text-decoration-none text-primary font-weight-medium">PPDB</a></li>
                <li class="breadcrumb-item"><a href="DataPendaftar.html"
                        class="text-decoration-none text-primary font-weight-medium">Data Pendaftar</a></li>
                <li class="breadcrumb-item active text-decoration-none font-weight-medium">Tambah Pendaftar</li>
            </ol>
        </nav>

        <!-- Page Header -->
        <div class="bg-white shadow-sm rounded p-4 mb-4 border-left border-primary"
            style="border-left-width: 4px !important;">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div class="mb-3 mb-md-0">
                    <h2 class="font-weight-bold text-primary mb-2">Edit Pendaftar</h2>
                    <p class="text-muted mb-0"><i class="fas fa-info-circle mr-1 text-info"></i>Formulir pendaftaran
                        siswa baru tahun ajaran 2025/2026</p>
                </div>
                <a href="DataPendaftar.html" class="btn btn-outline-primary font-weight-bold">
                    <i class="fas fa-arrow-left mr-2"></i>Kembali
                </a>
            </div>
        </div>

        <!-- Alert -->
        <div id="alert" class="alert alert-dismissible fade border-0 shadow-sm" role="alert" style="display: none;">
            <div class="d-flex align-items-center">
                <div class="mr-3">
                    <i id="alert-icon" class="fas fa-info-circle fa-2x"></i>
                </div>
                <div class="flex-grow-1">
                    <h6 id="alert-title" class="alert-heading font-weight-bold mb-1"></h6>
                    <div id="alert-content" class="mb-0"></div>
                </div>
            </div>
            <button type="button" class="close" onclick="hideAlert()">
                <span>&times;</span>
            </button>
        </div>

        <!-- Form -->
        <form id="registrarForm">

            <!-- Detail Pendaftaran -->
            <div class="card mb-4 border-0 shadow">
                <div class="card-header bg-gradient-primary text-black">
                    <h5 class="mb-0 font-weight-bold"><i class="fas fa-clipboard-list mr-2 text-primary"></i>DETAIL
                        PENDAFTARAN</h5>
                </div>
                <div class="card-body p-4">
                    <div class="row">
                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Nama Lengkap <span
                                    class="text-danger">*</span></label>
                            <input type="text" name="student_name" id="student-name" class="form-control border-primary"
                                maxlength="64">
                            <small id="student-name-feedback" class="text-danger font-weight-medium"
                                style="display: none;"></small>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Unit Pendidikan <span
                                    class="text-danger">*</span></label>
                            <select name="registrar_unit" id="registrar-unit" class="custom-select border-primary">
                                <option value="">-- Pilih Unit --</option>
                                <option value="SD">SD</option>
                                <option value="SMP">SMP</option>
                                <option value="SMA">SMA</option>
                            </select>
                            <small class="form-text text-muted">Menampilkan daftar unit pendidikan dengan status PPDB
                                aktif</small>
                            <small id="registrar-unit-feedback" class="text-danger" style="display: none;"></small>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label for="registrar-year" class="font-weight-bold text-dark mb-2">
                                Tahun Pendaftaran <span class="text-danger">*</span>
                            </label>
                            <select name="registrar_year" id="registrar-year" class="form-control border-primary">
                                <option value=""></option>
                                <option value="2026/2027">2026/2027</option>
                                <option value="2025/2026" selected>2025/2026</option>
                                <option value="2024/2025">2024/2025</option>
                                <option value="2023/2024">2023/2024</option>
                                <option value="2022/2023">2022/2023</option>
                                <option value="2021/2022">2021/2022</option>
                                <option value="2020/2021">2020/2021</option>
                                <option value="2019/2020">2019/2020</option>
                                <option value="2018/2019">2018/2019</option>
                                <option value="2017/2018">2017/2018</option>
                                <option value="2016/2017">2016/2017</option>
                                <option value="2015/2016">2015/2016</option>
                                <option value="2014/2015">2014/2015</option>
                            </select>
                            <small id="registrar-year-feedback" class="text-danger font-weight-medium"
                                style="display: none;"></small>
                        </div>

                        <div class="col-sm-12 col-md-4 mb-4">
                            <label for="registrar-status" class="font-weight-bold text-dark mb-2">
                                Status Pendaftaran <span class="text-danger">*</span>
                            </label>
                            <select name="registrar_status" id="registrar-status" class="form-control border-primary">
                                <option value=""></option>
                                <option value="1">Menunggu Pembayaran</option>
                                <option value="2" selected>Menunggu Persyaratan</option>
                                <option value="3">Menunggu Verifikasi</option>
                                <option value="4">Dalam Proses Seleksi</option>
                                <option value="5">Lulus Seleksi</option>
                                <option value="6">Tidak Lulus Seleksi</option>
                                <option value="7">Diterima</option>
                                <option value="8">Tidak Diterima</option>
                                <option value="9">Cadangan</option>
                                <option value="10">Daftar Ulang</option>
                                <option value="11">Telah Daftar Ulang</option>
                                <option value="12">Peserta Didik Baru</option>
                            </select>
                            <small id="registrar-status-feedback" class="text-danger font-weight-medium"
                                style="display: none;"></small>
                        </div>


                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Jenis Pendaftaran</label>
                            <select name="registrar_type" class="custom-select border-primary">
                                <option value="">-- Pilih Jenis --</option>
                                <option value="DAFTAR BARU">DAFTAR BARU</option>
                                <option value="PINDAHAN">PINDAHAN</option>
                            </select>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Periode Pendaftaran</label>
                            <select name="registrar_period" class="custom-select border-primary">
                                <option value="">-- Pilih Periode --</option>
                                <option value="1">01 Mei 2025 s.d 30 Juni 2025</option>
                            </select>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Jalur Pendaftaran</label>
                            <select name="registrar_path" class="custom-select border-primary">
                                <option value="">-- Pilih Jalur --</option>
                                <option value="AFIRMASI">AFIRMASI</option>
                                <option value="BEASISWA AKADEMIK">BEASISWA AKADEMIK</option>
                                <option value="BEASISWA TAHFIDZ">BEASISWA TAHFIDZ</option>
                                <option value="PERPINDAHAN ORANG TUA">PERPINDAHAN ORANG TUA</option>
                                <option value="PRESTASI">PRESTASI</option>
                                <option value="REGULER">REGULER</option>
                            </select>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Pilihan Jurusan I</label>
                            <select name="registrar_major" class="custom-select border-primary">
                                <option value="">-- Pilih Jurusan --</option>
                                <option value="IPA">IPA</option>
                                <option value="IPS">IPS</option>
                                <option value="IPS (Kelas Olah Raga)">IPS (Kelas Olah Raga)</option>
                                <option value="Keagamaan/Tahfidz">Keagamaan/Tahfidz</option>
                            </select>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label class="font-weight-bold text-dark mb-2">Pilihan Jurusan II</label>
                            <select name="registrar_major_second" class="custom-select border-primary">
                                <option value="">-- Pilih Jurusan --</option>
                                <option value="IPA">IPA</option>
                                <option value="IPS">IPS</option>
                                <option value="IPS (Kelas Olah Raga)">IPS (Kelas Olah Raga)</option>
                                <option value="Keagamaan/Tahfidz">Keagamaan/Tahfidz</option>
                            </select>
                        </div>

                        <div class="col-md-4 mb-4">
                            <label for="registrar-password" class="font-weight-bold text-dark mb-2">
                                Kata Sandi Baru <span class="text-danger">*</span>
                            </label>
                            <input type="password" name="registrar_password" id="registrar-password"
                                class="form-control border-primary" maxlength="16" autocomplete="off">
                            <small id="registrar-password-feedback" class="text-danger font-weight-medium"
                                style="display: none;"></small>
                        </div>
                    </div>

                    <div class="row my-4">
                        <div class="col-sm-12 col-md-4">
                            <div class="d-grid">
                                <button type="submit" id="btn-submit"
                                    class="btn btn-primary btn-block font-weight-bold shadow-sm d-flex align-items-center justify-content-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mr-2" width="22" height="22"
                                        viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <circle cx="12" cy="12" r="9"></circle>
                                        <path d="M9 12l2 2l4 -4"></path>
                                    </svg>
                                    <span>Simpan Data</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="bg-white py-3 mt-5">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12 text-center">
                            <p class="mb-0 text-muted">Powered By PPDB &copy; 2022-2025</p>
                        </div>
                    </div>
                </div>
            </footer>


            <div>
                <!-- Bootstrap 4 dependencies -->
                <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> <!-- versi full -->
                <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>


                <script>

                    fetch("../Navbar/navbar.html")
                        .then(res => res.text())
                        .then(html => {
                            const navbar = document.getElementById("navbar");
                            navbar.innerHTML = html;

                            // Menjalankan ulang semua script yang ada di navbar.html
                            navbar.querySelectorAll("script").forEach(oldScript => {
                                const newScript = document.createElement("script");
                                if (oldScript.src) {
                                    newScript.src = oldScript.src; // script eksternal
                                } else {
                                    newScript.innerHTML = oldScript.innerHTML; // inline script
                                }
                                document.body.appendChild(newScript);
                            });
                        });

                    $(document).ready(function () {
                        /* ===============================
                           ðŸŸ¦ 1. Bootstrap Navbar Dropdown
                        ================================*/
                        // Tidak perlu tambahan, Bootstrap otomatis aktif
                        // setelah jQuery + Popper + Bootstrap.bundle dimuat.

                        /* ===============================
                           ðŸŸ© 2. Tab Biodata (Bootstrap 4)
                        ================================*/
                        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                            // Hapus style dari semua tab
                            $('a[data-toggle="tab"]').removeClass('text-primary').addClass('text-muted')
                                .css('border-bottom', 'none');

                            // Tambahkan style ke tab aktif
                            $(e.target).addClass('text-primary').removeClass('text-muted')
                                .css({
                                    'border-bottom': '3px solid #3d5ce6',
                                    'transition': 'border-bottom 0.25s ease-in-out'
                                });
                        });

                        // Set kondisi awal (tab pertama)
                        $('a[data-toggle="tab"].active')
                            .addClass('text-primary')
                            .css('border-bottom', '3px solid #3d5ce6');

                        /* =======================================
                           ðŸŸ¨ 3. Detail Tagihan PPDB â€“ Interaktif
                        ========================================*/

                        // === Status Pembayaran (Pendaftaran) ===
                        $('#registrar-reg-payment-status').on('change', function () {
                            if ($(this).val() === 'Lunas') {
                                $('#select-reg-payment-method, #select-reg-payment-channel, #input-reg-payment-note').slideDown(300);
                            } else {
                                $('#select-reg-payment-method, #select-reg-payment-channel, #input-reg-payment-note').slideUp(300);
                            }
                        });

                        // === Checkbox Tagihan Daftar Ulang ===
                        $('#set-rereg-bill').on('change', function () {
                            if ($(this).is(':checked')) {
                                $('#rereg-bill').slideDown(300);
                            } else {
                                $('#rereg-bill').slideUp(300);
                            }
                        });

                        // === Status Pembayaran (Daftar Ulang) ===
                        $('#registrar-rereg-payment-status').on('change', function () {
                            if ($(this).val() === 'Lunas') {
                                $('#select-rereg-payment-method, #select-rereg-payment-channel, #input-rereg-payment-note').slideDown(300);
                            } else {
                                $('#select-rereg-payment-method, #select-rereg-payment-channel, #input-rereg-payment-note').slideUp(300);
                            }
                        });

                        // === Format nominal ke Rupiah ===
                        function formatRupiah(angka) {
                            let number_string = angka.replace(/[^,\d]/g, '').toString(),
                                split = number_string.split(','),
                                sisa = split[0].length % 3,
                                rupiah = split[0].substr(0, sisa),
                                ribuan = split[0].substr(sisa).match(/\d{3}/gi);

                            if (ribuan) {
                                separator = sisa ? '.' : '';
                                rupiah += separator + ribuan.join('.');
                            }

                            rupiah = split[1] !== undefined ? rupiah + ',' + split[1] : rupiah;
                            return rupiah;
                        }

                        $('#registrar-regcost-amount, #registrar-reregcost-amount').on('keyup', function () {
                            $(this).val(formatRupiah($(this).val()));
                        });

                        /* ===============================
                           ðŸŸ§ 4. Alert sederhana (opsional)
                        ================================*/
                        // Bisa dipakai nanti untuk notifikasi sukses/gagal
                        // Contoh: showAlert("success", "Berhasil", "Data disimpan!");
                        window.showAlert = function (type, title, message) {
                            alert(title + " â€” " + message);
                        };
                        // === STATUS PEMBAYARAN PENDAFTARAN ===
                        $('#registrar-reg-payment-status').on('change', function () {
                            if ($(this).val() === 'Lunas') {
                                $('#select-reg-payment-method, #select-reg-payment-channel, #input-reg-payment-note').slideDown(300);
                            } else {
                                $('#select-reg-payment-method, #select-reg-payment-channel, #input-reg-payment-note').slideUp(300);
                            }
                        }).trigger('change'); // supaya langsung sinkron dengan value awal

                        // === SWITCH TAGIHAN DAFTAR ULANG ===
                        $('#set-rereg-bill').on('change', function () {
                            if ($(this).is(':checked')) {
                                $('#rereg-bill').slideDown(300);
                            } else {
                                $('#rereg-bill').slideUp(300);
                            }
                        });

                        // === STATUS PEMBAYARAN DAFTAR ULANG ===
                        $('#registrar-rereg-payment-status').on('change', function () {
                            if ($(this).val() === 'Lunas') {
                                $('#select-rereg-payment-method, #select-rereg-payment-channel, #input-rereg-payment-note').slideDown(300);
                            } else {
                                $('#select-rereg-payment-method, #select-rereg-payment-channel, #input-rereg-payment-note').slideUp(300);
                            }
                        }).trigger('change');

                        // === FORMAT INPUT KE RUPIAH ===
                        function formatRupiah(angka) {
                            let number_string = angka.replace(/[^,\d]/g, '').toString(),
                                split = number_string.split(','),
                                sisa = split[0].length % 3,
                                rupiah = split[0].substr(0, sisa),
                                ribuan = split[0].substr(sisa).match(/\d{3}/gi);
                            if (ribuan) {
                                let separator = sisa ? '.' : '';
                                rupiah += separator + ribuan.join('.');
                            }
                            rupiah = split[1] !== undefined ? rupiah + ',' + split[1] : rupiah;
                            return rupiah;
                        }

                        $('#registrar-regcost-amount, #registrar-reregcost-amount').on('keyup', function () {
                            $(this).val(formatRupiah($(this).val()));
                        });

                        $('#load-photo').on('change', function (e) {
                            const file = e.target.files[0];
                            if (!file) return;
                            const reader = new FileReader();
                            reader.onload = function (evt) {
                                $('#preview-image').attr('src', evt.target.result);
                                $('#btn-remove-image').removeAttr('hidden');
                            };
                            reader.readAsDataURL(file);
                        });

                        // Hapus foto kembali default
                        $('#btn-remove-image').on('click', function () {
                            $('#preview-image').attr('src', 'https://demo.schoolpay.co.id/media/images/student/photo.png');
                            $('#load-photo').val('');
                            $(this).attr('hidden', true);
                        });
                    });
                </script>
</body>

</html>